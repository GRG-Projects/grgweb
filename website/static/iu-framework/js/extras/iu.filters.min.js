/*!
 * History API JavaScript Library v4.2.8
 *
 * Support: IE8+, FF3+, Opera 9+, Safari, Chrome and other
 *
 * Copyright 2011-2017, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 * Update: 2017-03-01 12:07
 */
!function(e){if("function"==typeof define&&define.amd){if("undefined"!=typeof requirejs){var t=requirejs,n="[history"+(new Date).getTime()+"]",r=t.onError;e.toString=function(){return n},t.onError=function(e){-1===e.message.indexOf(n)&&r.call(t,e)}}define([],e)}if("object"!=typeof exports||"undefined"==typeof module)return e();module.exports=e()}(function(){function e(){}function t(e,n,r){var i=/(?:([a-zA-Z0-9\-]+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/;if(null==e||""===e||n)e=n?e:b.href,R&&!r||(e=e.replace(/^[^#]*/,"")||"#",e=b.protocol.replace(/:.*$|$/,":")+"//"+b.host+G.basepath+e.replace(new RegExp("^#[/]?(?:"+G.type+")?"),""));else{var a=t(),o=y.getElementsByTagName("base")[0];!r&&o&&o.getAttribute("href")&&(o.href=o.href,a=t(o.href,null,!0));var c=a._pathname,f=a._protocol;e=""+e,e=/^(?:\w+\:)?\/\//.test(e)?0===e.indexOf("/")?f+e:e:f+"//"+a._host+(0===e.indexOf("/")?e:0===e.indexOf("?")?c+e:0===e.indexOf("#")?c+a._search+e:c.replace(/[^\/]+$/g,"")+e)}V.href=e;var l=i.exec(V.href),s=l[2]+(l[3]?":"+l[3]:""),u=l[4]||"/",p=l[5]||"",h="#"===l[6]?"":l[6]||"",d=u+p+h,v=u.replace(new RegExp("^"+G.basepath,"i"),G.type)+p;return{_href:l[1]+"//"+s+d,_protocol:l[1],_host:s,_hostname:l[2],_port:l[3]||"",_pathname:u,_search:p,_hash:h,_relative:d,_nohash:v,_special:v+h}}function n(){var e;try{e=g.sessionStorage,e.setItem(U+"t","1"),e.removeItem(U+"t")}catch(t){e={getItem:function(e){var t=y.cookie.split(e+"=");return t.length>1&&t.pop().split(";").shift()||"null"},setItem:function(e,t){var n={};(n[b.href]=S.state)&&(y.cookie=e+"="+x.stringify(n))}}}try{W=x.parse(e.getItem(U))||{}}catch(e){W={}}B(I+"unload",function(){e.setItem(U,x.stringify(W))},!1)}function r(t,n,r,i){var a=0;r||(r={set:e},a=1);var o=!r.set,c=!r.get,f={configurable:!0,set:function(){o=1},get:function(){c=1}};try{$(t,n,f),t[n]=t[n],$(t,n,r)}catch(e){}if(!(o&&c||(t.__defineGetter__&&(t.__defineGetter__(n,f.get),t.__defineSetter__(n,f.set),t[n]=t[n],r.get&&t.__defineGetter__(n,r.get),r.set&&t.__defineSetter__(n,r.set)),o&&c))){if(a)return!1;if(t===g){try{var l=t[n];t[n]=null}catch(e){}if("execScript"in g)g.execScript("Public "+n,"VBScript"),g.execScript("var "+n+";","JavaScript");else try{$(t,n,{value:e})}catch(e){"onpopstate"===n&&(B("popstate",r=function(){k("popstate",r,!1);var e=t.onpopstate;t.onpopstate=null,setTimeout(function(){t.onpopstate=e},1)},!1),J=0)}t[n]=l}else try{try{var s=E.create(t);$(E.getPrototypeOf(s)===t?s:t,n,r);for(var u in t)"function"==typeof t[u]&&(s[u]=t[u].bind(t));try{i.call(s,s,t)}catch(e){}t=s}catch(e){$(t.constructor.prototype,n,r)}}catch(e){return!1}}return t}function i(e,t,n){return n=n||{},e=e===X?b:e,n.set=n.set||function(n){e[t]=n},n.get=n.get||function(){return e[t]},n}function a(e,t,n){e in Z?Z[e].push(t):arguments.length>3?B(e,t,n,arguments[3]):B(e,t,n)}function o(e,t,n){var r=Z[e];if(r){for(var i=r.length;i--;)if(r[i]===t){r.splice(i,1);break}}else k(e,t,n)}function c(t,n){var i=(""+("string"==typeof t?t:t.type)).replace(/^on/,""),a=Z[i];if(a){if(n="string"==typeof t?n:t,null==n.target)for(var o=["target","currentTarget","srcElement","type"];t=o.pop();)n=r(n,t,{get:"type"===t?function(){return i}:function(){return g}});J&&(("popstate"===i?g.onpopstate:g.onhashchange)||e).call(g,n);for(var c=0,f=a.length;c<f;c++)a[c].call(g,n);return!0}return D(t,n)}function f(){var e=y.createEvent?y.createEvent("Event"):y.createEventObject();e.initEvent?e.initEvent("popstate",!1,!1):e.type="popstate",e.state=S.state,c(e)}function l(){z&&(z=!1,f())}function s(e,n,r,i){if(R)q=b.href;else{0===M&&(M=2);var a=t(n,2===M&&-1!==(""+n).indexOf("#"));a._relative!==t()._relative&&(q=i,r?b.replace("#"+a._special):b.hash=a._special)}!T&&e&&(W[b.href]=e),z=!1}function u(e){var n=q;if(q=b.href,n){C!==b.href&&f(),e=e||g.event;var r=t(n,!0),i=t();e.oldURL||(e.oldURL=r._href,e.newURL=i._href),r._hash!==i._hash&&c(e)}}function p(e){setTimeout(function(){B("popstate",function(e){C=b.href,T||(e=r(e,"state",{get:function(){return S.state}})),c(e)},!1)},0),!R&&!0!==e&&"location"in S&&(v(j.hash),l())}function h(e){for(;e;){if("A"===e.nodeName)return e;e=e.parentNode}}function d(e){var n=e||g.event,r=h(n.target||n.srcElement),i="defaultPrevented"in n?n.defaultPrevented:!1===n.returnValue;if(r&&"A"===r.nodeName&&!i){var a=t(),o=t(r.getAttribute("href",2));a._href.split("#").shift()===o._href.split("#").shift()&&o._hash&&(a._hash!==o._hash&&(j.hash=o._hash),v(o._hash),n.preventDefault?n.preventDefault():n.returnValue=!1)}}function v(e){var t=y.getElementById(e=(e||"").replace(/^#/,""));if(t&&t.id===e&&"A"===t.nodeName){var n=t.getBoundingClientRect();g.scrollTo(m.scrollLeft||0,n.top+(m.scrollTop||0)-(m.clientTop||0))}}var g=("object"==typeof window?window:this)||{};if(!g.history||"emulate"in g.history)return g.history;var _,y=g.document,m=y.documentElement,E=g.Object,x=g.JSON,b=g.location,O=g.history,S=O,w=O.pushState,A=O.replaceState,R=function(){var e=g.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&!!w}(),T="state"in O,$=E.defineProperty,j=r({},"t")?{}:y.createElement("a"),I="",L=g.addEventListener?"addEventListener":(I="on")&&"attachEvent",P=g.removeEventListener?"removeEventListener":"detachEvent",N=g.dispatchEvent?"dispatchEvent":"fireEvent",B=g[L],k=g[P],D=g[N],G={basepath:"/",redirect:0,type:"/",init:0},U="__historyAPI__",V=y.createElement("a"),q=b.href,C="",J=1,z=!1,M=0,W={},Z={},F=y.title,H={onhashchange:null,onpopstate:null},K=function(e,t){var n=g.history!==O;n&&(g.history=O),e.apply(O,t),n&&(g.history=S)},Q={setup:function(e,t,n){G.basepath=(""+(null==e?G.basepath:e)).replace(/(?:^|\/)[^\/]*$/,"/"),G.type=null==t?G.type:t,G.redirect=null==n?G.redirect:!!n},redirect:function(e,n){if(S.setup(n,e),n=G.basepath,g.top==g.self){var r=t(null,!1,!0)._relative,i=b.pathname+b.search;R?(i=i.replace(/([^\/])$/,"$1/"),r!=n&&new RegExp("^"+n+"$","i").test(i)&&b.replace(r)):i!=n&&(i=i.replace(/([^\/])\?/,"$1/?"),new RegExp("^"+n,"i").test(i)&&b.replace(n+"#"+i.replace(new RegExp("^"+n,"i"),G.type)+b.hash))}},pushState:function(e,t,n){var r=y.title;null!=F&&(y.title=F),w&&K(w,arguments),s(e,n),y.title=r,F=t},replaceState:function(e,t,n){var r=y.title;null!=F&&(y.title=F),delete W[b.href],A&&K(A,arguments),s(e,n,!0),y.title=r,F=t},location:{set:function(e){0===M&&(M=1),g.location=e},get:function(){return 0===M&&(M=1),j}},state:{get:function(){return"object"==typeof W[b.href]?x.parse(x.stringify(W[b.href])):void 0!==W[b.href]?W[b.href]:null}}},X={assign:function(e){R||0!==(""+e).indexOf("#")?b.assign(e):s(null,e)},reload:function(e){b.reload(e)},replace:function(e){R||0!==(""+e).indexOf("#")?b.replace(e):s(null,e,!0)},toString:function(){return this.href},origin:{get:function(){return void 0!==_?_:b.origin?b.origin:b.protocol+"//"+b.hostname+(b.port?":"+b.port:"")},set:function(e){_=e}},href:R?null:{get:function(){return t()._href}},protocol:null,host:null,hostname:null,port:null,pathname:R?null:{get:function(){return t()._pathname}},search:R?null:{get:function(){return t()._search}},hash:R?null:{set:function(e){s(null,(""+e).replace(/^(#|)/,"#"),!1,q)},get:function(){return t()._hash}}};return function(){var e=y.getElementsByTagName("script"),a=(e[e.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,function(e,t,n){G[t]=(n||"").replace(/^(0|false)$/,"")}),B(I+"hashchange",u,!1);var o=[X,j,H,g,Q,S];T&&delete Q.state;for(var c=0;c<o.length;c+=2)for(var f in o[c])if(o[c].hasOwnProperty(f))if("object"!=typeof o[c][f])o[c+1][f]=o[c][f];else{var l=i(o[c],f,o[c][f]);if(!r(o[c+1],f,l,function(e,t){t===S&&(g.history=S=o[c+1]=e)}))return k(I+"hashchange",u,!1),!1;o[c+1]===g&&(Z[f]=Z[f.substr(2)]=[])}return S.setup(),G.redirect&&S.redirect(),G.init&&(M=1),!T&&x&&n(),R||y[L](I+"click",d,!1),"complete"===y.readyState?p(!0):(R||t()._relative===G.basepath||(z=!0),B(I+"load",p,!1)),!0}()?(S.emulate=!R,g[L]=a,g[P]=o,g[N]=c,S):void 0});
/*!
 * IU: Form Filter
 */
!function(t,e,o,i){"use strict";function n(e,o,i){this.$form=e,this.$selections=t("#filter-selection"),this.$pagination=t("#filter-pagination"),this.$mobilePagination=t("#filter-pagination-mobile"),this.$results=t("#filter-results"),this.yourSelections={},this.settings=i,this.usePopover=void 0===this.$form.data("popover")||this.$form.data("popover"),this.useSelections=void 0===this.$form.data("selections")||this.$form.data("selections"),this.setup()}var r=(e.history.location||e.location,e.IU||{});n.prototype.setup=function(){this.settings.handlePageLoad&&this.handlePageLoad(),this.submitPath=this.formSubmitPath(),this.bindFormSubmit(),this.bindClickEvents(),this.bindSelectEvents(),this.bindTextInput(),this.bindNumberInput(),this.bindRadioEvents(),this.bindCheckboxEvents(),this.bindPaginationEvents(),this.usePopover&&this.buildPopover(),this.hideSubmitButton()},n.prototype.hideSubmitButton=function(){this.$form.removeClass("grid-has-submit"),t('button[type="submit"]',this.$form).hide()},n.prototype.ajaxScroll=function(e){var o=this;t("html, body").animate({scrollTop:o.$results.offset().top-e},1e3)},n.prototype.formSubmitPath=function(){var t=this,e=t.$form.attr("action");return void 0!==t.$form.data("api")&&(e=t.$form.data("api")),e},n.prototype.bindFormSubmit=function(){var e=this,o=e.$form;o.on("submit",function(i,n){i.preventDefault();var r=e.yourSelections,a=e.createQueryString(r);e.useSelections||(a=o.serialize()),e.addSpinner(),e.settings.dev||t.ajax({url:e.submitPath,data:a,method:o.attr("method"),dataType:"html",success:function(t){e.handleResponse(t)}}),history.replaceState(a,null,"?"+a)})},n.prototype.bindClickEvents=function(){var e=this;e.$selections.on("click","a.select-item",function(o){o.preventDefault();var i=t(this).data("name");e.removeSelection(i),e.$form.trigger("submit")})},n.prototype.bindTextInput=function(){var e=this;t("input[type='text']",e.$form).on("keyup",r.utils.throttle(function(o){var i=t(this),n=i.attr("name"),r="Search text: "+i.val(),a=i.val();e.selectionCrud(i,n,a,r)},750))},n.prototype.bindNumberInput=function(){var e=this;t("input[type='number']",e.$form).on("input",function(o){var i=t(this),n=i.attr("name"),r="Search text: "+i.val(),a=i.val();e.selectionCrud(i,n,a,r)})},n.prototype.bindCheckboxEvents=function(){var e=this;t("input[type='checkbox']",e.$form).on("change",function(o){var i=t(this),n=i.closest(".alpha.checkboxes"),r=i.attr("name"),a="Search text: "+i.is(":checked"),s=i.is(":checked")?i.val():"0";n.length&&n.find('input[type="checkbox"]').not(i).prop("checked",!1),e.selectionCrud(i,r,s,a)})},n.prototype.bindRadioEvents=function(){var e=this;t("input[type='radio']",e.$form).on("change",function(o){e.$form.trigger("submit");var i=t(this),n=i.attr("name"),r=i.val(),a=i.val();console.log(n,r,a),e.selectionCrud(i,n,a,r)}),t("input[type='radio']",e.$form).on("")},n.prototype.bindSelectEvents=function(){var e=this;t("select[data-ajax='true']").on("change",function(){var o=t(this),i=o.data("results-endpoint"),n=o.data("controls");({})[o.attr("name")]=o.val(),o.trigger("IU.reset-ajax-child");var r=t(n);r.empty(),t.ajax({url:i,method:e.$form.attr("method"),data:e.$form.serialize(),success:function(e,o,i){if(i.getResponseHeader("Content-Type").includes("text/html")){var a=t(e).find(n).html();r.html(a)}else t.each(e,function(t,e){r.append("<option value='"+e.id+"'>"+e.name+"</option>")})}})}),t("select[data-ajax='true']").on("IU.reset-ajax-child",function(o){var i=t(this),n=i.data("controls"),r=t(n),a=r.attr("name");e.removeSelection(a),t(":first",r).prop("selected",!0),t(":not(:first)",r).remove()}),e.$form.on("change","select",function(){var o=t(this),i=t("option:selected",o),n=o.attr("name"),r=i.text(),a=i.val();e.selectionCrud(o,n,a,r)})},n.prototype.bindPaginationEvents=function(){var e=this;e.$mobilePagination.find("a.selector").removeAttr("href"),e.$mobilePagination.on("click","a.button.next, a.button.previous",function(o){o.preventDefault();var i=t(this),n=i.attr("href");e.paginationSubmit(n,80)}),e.$mobilePagination.on("change","select.pagination",function(o){o.preventDefault();var i=t(this),n=t("option:selected",i).val();e.paginationSubmit(n,80)}),t(e.$pagination).on("click","a",function(o){o.preventDefault();var i=t(this);t("li",e.$pagination).removeClass("current"),i.closest("li").addClass("current");var n=i.attr("href");e.paginationSubmit(n,100)})},n.prototype.paginationSubmit=function(e,o){var i=this;i.ajaxScroll(o),t.get(i.submitPath+e,function(t){i.handleResponse(t)}),history.replaceState(e,null,e)},n.prototype.handleResponse=function(e){var o=this;e=t("<div />").append(jQuery.parseHTML(e)),o.replaceResults(e),o.replacePagination(e),o.removeSpinner(),o.replaceCount(e),r.helpers&&r.helpers.emailObfuscation.call(r),r.helpers&&r.helpers.externalLinksInNewTabs.call(r)},n.prototype.replaceResults=function(e){var o=this,i=t(e).find("#filter-results, #results").html();i=void 0===i?"&nbsp;":i,o.$results.html(i)},n.prototype.replacePagination=function(e){var o=this,i=t("#filter-pagination",e).html(),n=t("#filter-pagination-mobile",e).html();i=void 0===i?"&nbsp;":i,n=void 0===n?"&nbsp;":n,o.$pagination.html(i),o.$mobilePagination.html(n),o.$mobilePagination.find("a.selector").removeAttr("href")},n.prototype.replaceCount=function(e){var o=t("#filter-selection .result-count",e),i=o.data("label")&&o.data("label").length?o.data("label"):"results found",n=t("#filter-selection .result-count span",e).html(),r=n?"<span>"+n+"</span> "+i:"<span></span>";t(".result-count").html(r)},n.prototype.selectionCrud=function(t,e,o,i){var n=this;if(delete n.yourSelections.page,t.data("isFiltered")){if(""===o||"0"===o||"all"===o)return n.removeSelection(e),r.debug("Remove Selection"),void n.$form.trigger("submit");if(""!==o)return n.updateSelection(e,o,i),r.debug("Update Selection"),void n.$form.trigger("submit")}if(""!==o||"0"!==o||"all"!==o)return n.addSelection(t,e,o,i),r.debug("Add Selection"),t.data("isFiltered",!0),void n.$form.trigger("submit")},n.prototype.addSelection=function(e,o,i,n){var r=this,a=t("<a>",{class:"select-item",href:"#",text:n,"data-name":o,"data-value":i});r.yourSelections[o]=i,"checkbox"!==e.attr("type")&&"radio"!==e.attr("type")&&(r.yourSelections.hasOwnProperty("clear-all")||r.buildClearButton(),t(a).insertBefore(".clear",r.$selections))},n.prototype.updateSelection=function(e,o,i){var n=this,r=t('[data-name="'+e+'"]',n.$selections);n.yourSelections[e]=o,r.attr("data-value",o),r.text(i),i.length||n.removeSelection(e)},n.prototype.removeSelection=function(e){var o=this,i=t('[data-name="'+e+'"]',o.$selections);"clear-all"!==e&&o.resetFormItem(e),"clear-all"!==e&&1!==Object.keys(o.yourSelections).length||o.clearAllSelections(),i.remove()},n.prototype.resetFormItem=function(e){var o=this,i=o.$form.find('[name="'+e+'"]');i.is(":text")&&i.val(""),i.is("select")&&(t(":first",i).prop("selected",!0),i.trigger("IU.reset-ajax-child")),i.is(":checkbox")&&i.prop("checked",!1),"letter"===e&&(i=t(".form-item.alpha"),t(".form-item.alpha li").removeClass("current")),i.removeData("isFiltered"),delete o.yourSelections[e]},n.prototype.buildClearButton=function(){var e=this;e.yourSelections["clear-all"]="Clear selections";var o=t("<a>",{class:"select-item clear",href:"#",text:"Clear selections","data-name":"clear-all","data-value":"clear-all"});t(".content",e.$selections).append(o)},n.prototype.clearAllSelections=function(){var e=this;for(name in e.yourSelections)e.resetFormItem(name);e.yourSelections={},t(".content",e.$selections).html("")},n.prototype.buildPopover=function(){var e=this;if(e.usePopover){var o=t('<div class="popoverScreen" />'),i=t("#filter-selection");e.$popoverScreen=o,e.$form.before(o),e.buildFilterControls(),e.addViewResultsButton(),enquire.register("screen and (max-width: 40em)",{match:function(){e.$form.addClass("popover"),t(".result-count",i).hide(),e.$filterControls.show(),e.$viewResultsButton.show()},unmatch:function(){e.closePopover(),e.$form.removeClass("popover"),e.$filterControls.hide(),e.$viewResultsButton.hide(),t(".result-count",i).show()}})}},n.prototype.buildFilterControls=function(e){var i=this,n=t(".result-count",i.$selections).html();void 0===n&&(n="");var r=t('<div id="filter-controls" class="clearfix" />'),a=t('<p class="float-left left result-count">'+n+"</p>"),s=t('<div class="float-right right"><a href="#" class="open-popover button button-small">Filter Results</a></div>');r.append(a),r.append(s),r.hide(),t(o).on("click","a.open-popover",function(t){t.preventDefault(),i.openPopover()}),i.$filterControls=r,i.$filterControls.insertBefore(i.$form)},n.prototype.addViewResultsButton=function(){var e=this,o=t('<button type="button" class="button close">View Results</button>');o.hide(),e.$form.append(o),e.$viewResultsButton=o},n.prototype.openPopover=function(){var e=this,o=t(".filter-title .label",e.$form);r.preventHTMLScroll(),o.length?o.addClass("modal-title").append("<span class='close right'>&times;</span>"):(o=t("<h4 class='modal-title custom'>Filters <span class='close right'>&times;</span></h4>"),e.$form.prepend(o)),e.$form.addClass("open"),e.$popoverScreen.addClass("open"),e.$form.on("click",".close",e.closePopover.bind(e)),e.$popoverScreen.on("click",e.closePopover.bind(e))},n.prototype.closePopover=function(){var e=this;e.$form.removeClass("open"),r.enableHTMLScroll(),t(".modal-title.custom",e.$form).remove(),e.$form.find(".close.right").remove(),e.$popoverScreen.removeClass("open")},n.prototype.handlePageLoad=function(){var e=this,o=e.getQueryParameters();e.yourSelections=o||{};for(var i in e.yourSelections){var n=e.$form.find('[name="'+i+'"]');"letter"===i&&(n=t(":checkbox[value="+e.yourSelections[i]+"]",e.$form).prop("checked",!0)),"all"!==e.yourSelections[i]?n.data("isFiltered",!0):delete e.yourSelections[i]}Object.keys(e.yourSelections).length&&(e.yourSelections["clear-all"]="Clear selections")},n.prototype.getQueryParameters=function(t){return!(t=t||o.location.search)&&{}||t.replace(/(^\?)/,"").split("&").map(function(t){return t=t.split("="),this[t[0]]=t[1],this}.bind({}))[0]},n.prototype.createQueryString=function(t){var e=[];for(var o in t)t.hasOwnProperty(o)&&"clear-all"!==o&&e.push(encodeURIComponent(o)+"="+encodeURIComponent(t[o]));return e.join("&")},n.prototype.addSpinner=function(){t(".result-count").addClass("loading"),t(".result-count span").html("")},n.prototype.removeSpinner=function(){t(".result-count").removeClass("loading")},r.FormFilter=n,r.addInitalisation("form-filter",function(){var e=arguments[0];t("form.filter").each(function(o){var i=t(this);if(i.data("isFormFilter"))return!0;i.data("isFormFilter",!0);new r.FormFilter(i,o,e)})}),r.UIModule({module:"form-filter",settings:{dev:!1,handlePageLoad:!0},init:function(){r.initialize("form-filter",this.settings)}})}(jQuery,window,window.document);